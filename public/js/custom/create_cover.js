var months="Jan Feb Mar Apr May Jun Jul Agu Sep Okt Nov Dec".split(" "),date=new Date,yy=date.getYear(),mon=date.getMonth(),day=date.getDate(),min=date.getMinutes(),sec=date.getSeconds(),msec=date.getMilliseconds(),year=1E3>yy?yy+1900:yy,aws=msec+"_"+sec+"_"+min+"_"+day+"_"+months[mon]+"_"+year;
function tampilkanPreview(b,a){for(var c=b.files,f=0;f<c.length;f++){var e=c[f],d=document.getElementById(a),g=new FileReader;e.type.match(/image.*/)?(d.file=e,g.onload=function(d){return function(a){d.src=a.target.result}}(d),g.readAsDataURL(e)):alert("Type file tidak sesuai. Khusus image.")}}
$(document).ready(function(){function b(d){d=d.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);delete d[0];for(var a=1;3>=a;++a)d[a]=parseInt(d[a]).toString(16),1==d[a].length&&(d[a]="0"+d[a]);c="#"+d.join("")}$(".backbtn").on("click",function(){window.history.go(-1)});var a=$(window).width();768>a?$(".stickymenu").trigger("sticky_kit:detach"):$(".stickymenu").stick_in_parent();$(window).resize(function(){a=$(window).width();768>a?$(".stickymenu").trigger("sticky_kit:detach"):$(".stickymenu").stick_in_parent()});
$("#txt-size1").click(function(){$("#parenttxttitle").removeClass().toggleClass("txt-h1")});$("#txt-size2").click(function(){$("#parenttxttitle").removeClass().toggleClass("txt-h2")});$("#txt-size3").click(function(){$("#parenttxttitle").removeClass().toggleClass("txt-h3")});$("#txt-size4").click(function(){$("#parenttxttitle").removeClass().toggleClass("txt-h4")});$("#txt-size5").click(function(){$("#parenttxttitle").removeClass().toggleClass("txt-h5")});$("#txt-size6").click(function(){$("#parenttxttitle").removeClass().toggleClass("txt-h6")});
$("#txt-font1").click(function(){$("#txtfontfam").removeClass().toggleClass("setfont1")});$("#txt-font2").click(function(){$("#txtfontfam").removeClass().toggleClass("setfont2")});$("#txt-font3").click(function(){$("#txtfontfam").removeClass().toggleClass("setfont3")});$("#txt-font4").click(function(){$("#txtfontfam").removeClass().toggleClass("setfont4")});$("#txt-font5").click(function(){$("#txtfontfam").removeClass().toggleClass("setfont5")});$("#a-topleft").click(function(){$("#coverCreation, #texttitle").removeClass().toggleClass("text-left")});
$("#a-topmid").click(function(){$("#coverCreation, #texttitle").removeClass().toggleClass("text-center")});$("#a-topright").click(function(){$("#coverCreation, #texttitle").removeClass().toggleClass("text-right")});$("#a-centerleft").click(function(){$("#coverCreation").removeClass().toggleClass("text-left");$("#texttitle").removeClass().toggleClass("a-txtcenter")});$("#a-centermid").click(function(){$("#coverCreation").removeClass().toggleClass("text-center");$("#texttitle").removeClass().toggleClass("a-txtcenter")});
$("#a-centerright").click(function(){$("#coverCreation").removeClass().toggleClass("text-right");$("#texttitle").removeClass().toggleClass("a-txtcenter")});$("#a-botleft").click(function(){$("#coverCreation").removeClass().toggleClass("text-left");$("#texttitle").removeClass().toggleClass("a-txtbot")});$("#a-botmid").click(function(){$("#coverCreation").removeClass().toggleClass("text-center");$("#texttitle").removeClass().toggleClass("a-txtbot")});$("#a-botright").click(function(){$("#coverCreation").removeClass().toggleClass("text-right");
$("#texttitle").removeClass().toggleClass("a-txtbot")});var c="";$(".colortxt").click(function(){var a=$(this).css("backgroundColor");b(a);$("#textcolor").css({color:c})});$(".colorbg").click(function(){var a=$(this).css("backgroundColor");b(a);$("#bg-cover").css({background:c})});$(".colorbgmr").click(function(){var a=$(this).css("backgroundColor");b(a);$(".yourimage").css({background:c})});$(".colorfontmr").click(function(){var a=$(this).css("backgroundColor");b(a);$("#title_book").css({color:c})});
var f=$("#yourcoverimage"),e;$("#done-cover").on("click",function(){html2canvas(f,{onrendered:function(a){$("#previewImage").after(a);e=a;a=e.toDataURL("image/png");a=atob(a.split(",")[1]);for(var c=[],b=0;b<a.length;b++)c.push(a.charCodeAt(b));a=new Blob([new Uint8Array(c)],{type:"image/png"});var d=new FormData;d.append("book_id",$("input:hidden[name=iaiduui]").val());d.append("cover_url",a,aws+".png");swal({title:"Ingin menggunakan cover ini?",text:"Anda tidak dapat mengubah cover lagi",type:"warning",
showCancelButton:!0,confirmButtonColor:"#b54aca",cancelButtonColor:"#d33",confirmButtonText:"Ya, Gunakan",cancelButtonText:"Tidak, Ubah ulang"}).then(function(a){a.value&&(HoldOn.open({theme:"sk-bounce",message:"Tunggu sebentar..."}),$.ajax({async:!0,crossDomain:!0,url:"send_cover",method:"post",processData:!1,contentType:!1,dataType:"json",mimeType:"multipart/form-data",data:d,success:function(a){HoldOn.close();window.location.href=document.referrer;IE&&(a=document.createElement("a"),a.href=URLtoCall,
document.body.appendChild(a),a.click())},error:function(){console.log("Error")}}))})}})})});
function showHide(b){"gallery"==b?($(".gallery").show(),$(".txt").hide()):"txt"==b&&($(".gallery").hide(),$(".txt").show(),$(".txt").css("display",""),$(".draggable").draggable({start:function(a,c){$(this).data("preventBehaviour",!0)}}),$(".draggable").find(":input").on("mousedown",function(a){a=new MouseEvent("mousedown",{screenX:a.screenX,screenY:a.screenY,clientX:a.clientX,clientY:a.clientY,view:window});$(this).closest(".draggable")[0].dispatchEvent(a)}).on("click",function(a){var c=$(this).closest(".draggable");
c.data("preventBehaviour")&&(a.preventDefault(),c.data("preventBehaviour",!1))}))}function appendToCover(){$(".coverCreationmr").show();$("#title_book").focus();$(".tab_txt").hide();$(".tab_txt_menu").show()}
$(document).ready(function(){$(".draggable").draggable();$("#font-size").change(function(){var b=$(this).val();$("#title_book").css("font-size",b)});$("#bold-text").click(function(){$(this).val();$("#title_book").css("font-weight","bold")});$("#italic-text").click(function(){$(this).val();$("#title_book").css("font-style","italic")});$("#font-style").change(function(){var b=$(this).val();$("#title_book").removeClass().toggleClass(b)});$(".btn-color").click(function(){$("#not-color").hide();$("#color-show").show()});
$("#cover_finish").click(function(){var b=$(".yourimage");html2canvas(b,{onrendered:function(a){$("#previewImage").after(a);getCanvas=a;a=getCanvas.toDataURL("image/png");a=atob(a.split(",")[1]);for(var c=[],b=0;b<a.length;b++)c.push(a.charCodeAt(b));a=new Blob([new Uint8Array(c)],{type:"image/png"});c=new FormData;c.append("book_id",$("input:hidden[name=iaiduui]").val());c.append("cover_url",a,aws+".png");$.ajax({async:!0,crossDomain:!0,url:"send_cover",method:"post",processData:!1,contentType:!1,
dataType:"json",mimeType:"multipart/form-data",data:c,success:function(a){window.history.go(-1);IE&&(a=document.createElement("a"),a.href=URLtoCall,document.body.appendChild(a),a.click())},error:function(){console.log("Error")}})}})})});